---
title: 文字範本轉換流程
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, transformation process
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- multiple
ms.prod: visual-studio-dev15
ms.technology: vs-ide-modeling
ms.openlocfilehash: b9c65762bbc1fe068889c0420f0dec3d28000130
ms.sourcegitcommit: e13e61ddea6032a8282abe16131d9e136a927984
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/26/2018
ms.locfileid: "31951176"
---
# <a name="the-text-template-transformation-process"></a>文字範本轉換流程
文字範本轉換流程接受文字範本檔做為輸入，並產生新的文字檔，做為輸出。 例如，您可以使用文字範本產生 Visual Basic 或 C# 程式碼，或您可以產生 HTML 報表。

 三個元件需要在此程序： 引擎、 主機和指示詞處理器。 此引擎會控制處理序;它與主機和指示詞處理器，以產生輸出檔的互動。 主機提供與環境中，例如尋找檔案和組件的任何互動。 指示詞處理器加入功能，例如從 XML 檔案或資料庫讀取資料。

 文字範本轉換流程是在兩個步驟執行。 首先，引擎會建立暫存的類別，也就是產生之轉換類別。 這個類別包含指示詞和控制區塊產生的程式碼。 在這之後，引擎會編譯並執行產生之轉換類別來產生輸出檔。

## <a name="components"></a>元件

|元件|描述|可自訂 （是/否）|
|---------------|-----------------|------------------------------|
|引擎|引擎元件控制文字範本轉換流程|否。|
|主機|主機為引擎與使用者環境之間的介面。 [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] 是文字轉換程序的主機。|可以。 您可以撰寫自訂主機。|
|指示詞處理器|指示詞處理器的處理中的文字範本指示詞的類別。 您可以使用指示詞提供資料給文字範本，從輸入來源。|可以。 您可以撰寫自訂指示詞處理器|

## <a name="the-engine"></a>引擎
 引擎會接收範本當做主機會處理轉換程序中使用的所有檔案的字串。 引擎會接著詢問要找出任何自訂指示詞處理器和環境的其他方面的主機。 然後，引擎會編譯，並執行產生之轉換類別。 引擎會傳回產生的文字至主機，通常會將文字儲存至檔案。

## <a name="the-host"></a>主應用程式
 主機負責與轉換程序，包括下列外部環境相關的任何項目：

-   尋找文字和二進位引擎或指示詞處理器所要求的檔案。 主機可以搜尋目錄和全域組件快取，以找出組件。 主機可以找到自訂指示詞處理器程式碼引擎。 主機也可以尋找和讀取文字檔案並傳回其內容為字串。

-   提供的標準組件和引擎用來建立產生之轉換類別的命名空間的清單。

-   提供應用程式定義域時，引擎會編譯並執行產生之轉換類別所使用。 保護主應用程式發生錯誤的範本程式碼會使用個別的應用程式網域。

-   撰寫產生的輸出檔。

-   設定產生的輸出檔的預設副檔名。

-   處理文字範本轉換錯誤。 比方說，主機可以在使用者介面中顯示的錯誤，或將它們寫入至檔案。 (在[!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]，錯誤會顯示錯誤訊息視窗中。)

-   如果使用者已呼叫指示詞，而不提供值，請提供必要的參數值。 指示詞處理器可以指定指示詞，並使用參數的名稱，並要求者提供的預設值，如果有的話。

## <a name="directives-and-directive-processors"></a>指示詞和指示詞處理器
 指示詞是在文字範本中的命令。 它提供產生程序的參數。 通常指示詞所定義的來源和類型的模型或其他的輸入和輸出檔的副檔名。

 指示詞處理器可以處理一或多個指示詞。 當您轉換範本時，您必須安裝在範本中的指示詞可處理指示詞處理器。

 指示詞效果所產生之轉換類別中加入程式碼。 建立產生之轉換類別時，您可以呼叫從文字範本，而且引擎處理指示詞的所有呼叫的指示詞。 為能順利呼叫指示詞之後，您撰寫文字範本中的程式碼的其餘部分可以依賴指示詞提供的功能。 例如，您可以進行下列呼叫`import`在範本指示詞：

 `<#@ import namespace="System.Text" #>`

 標準的指示詞處理器會將轉換為`using`產生之轉換類別中的陳述式。 然後您可以使用`StringBuilder`類別完全不需限定它做為範本程式碼的其餘部分`System.Text.StringBuilder`。