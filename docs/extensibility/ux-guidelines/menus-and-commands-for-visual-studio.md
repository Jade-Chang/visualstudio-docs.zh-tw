---
title: 功能表和命令適用於 Visual Studio |Microsoft 文件
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: 16f67faf7ffe3a3fd119b7ddf002ab463822a830
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/16/2018
---
# <a name="menus-and-commands-for-visual-studio"></a>功能表和 Visual Studio 的命令
## <a name="command-usage"></a>命令使用方式  
  
### <a name="overview"></a>總覽  
 與 Microsoft Office，這是一套可包含許多不同的產品，不同的是 Visual Studio 包含許多產品，每個會造成全域的 Visual Studio ide 的命令集。 IDE 會篩選內容會根據使用者所提供的功能來管理數千個命令的複雜性。  
  
 變更使用者的內容-例如從 [設計] 視窗切換到編輯視窗的程式碼，而功能不相關的到新的內容就會消失。 在相同的時間，以及相關的動態資訊，例如屬性和 [工具箱] 選項的新功能介面。 使用者應該不會注意到可用的命令集的交換。 如果使用者是團體或混淆命令時，出現或消失，UI 設計需要調整。 使用者的目前內容是一律以一或多個方法，例如 IDE 標題列、 [屬性] 視窗或 [屬性頁] 對話方塊中。  
  
 命令列允許在 UI 中的彈性。 只有命令結構於 Visual Studio 環境會在主功能表和主要的命令列可同時自訂和即使隱藏固有的。 其他命令列會出現，而會消失根據應用程式的狀態。 工具視窗和文件編輯器也可以包含內嵌的工具列中其視窗邊緣。  
  
#### <a name="basic-guidelines"></a>基本指導方針  
  
##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>使用現有的共用的命令、 命令群組，以及盡可能功能表。  
 因為命令通常會顯示根據內容，使用現有的共用的功能表和命令群組確保命令結構內容中的變更之間相當穩定。 重複使用共用的命令，並將新接近共用的相關命令的命令也可降低複雜性 IDE，並建立更方便使用的經驗。 如果需要定義新的命令，請將它放在現有的共用的命令群組。 如果新的群組，必須定義，將它放在現有的共用接近相關的命令群組功能表建立新的最上層功能表之前。  
  
##### <a name="do-not-create-icons-for-every-command"></a>不會建立每個命令的圖示。  
 建立命令圖示之前請仔細考慮。 圖示應該只會針對命令建立的：  
  
-   會出現在預設工具列。  
  
-   可能的使用者加入至工具列，以透過**自訂...**對話方塊。  
  
-   有另一個 Microsoft 產品中相同的動作相關聯的圖示。  
  
##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制的鍵盤快速鍵  
 大多數使用者採用極少數的所有可用的快速鍵。 有疑問，未繫結您的功能為鍵盤快速鍵。 以您的使用者的工作經驗小組然後再加入新的快速鍵。  
  
##### <a name="give-commands-a-default-menu-placement"></a>提供命令功能表中有預設位置。  
 請注意，您的命令會由其他人自訂和據此設計它們。 沒有這類的隱藏的命令。 所有的 Visual Studio 命令會出現在**工具 > 自訂** 對話方塊中，命令視窗中，自動完成**工具 > 選項 > 鍵盤** 對話方塊，並開發工具環境 (DTE)。 請確定您的命令名稱和指定給.ctc 檔中的工具提示，讓使用者可以輕鬆地尋找。  
  
##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不會重複內嵌的工具列上的共用的命令。  
 最好將命令放在接近使用者的焦點區域。 執行這項操作的一種方式是在工具視窗或文件頂端編輯器建立內嵌的工具列。 應該在視窗內的內容區域的特定放在工具列上的命令。 不會重複這些工具列上的共用的命令。 例如，永遠不會將內嵌的工具列中的 [儲存] 圖示。  
  
### <a name="content-and-command-visibility"></a>內容和命令的可見性  
 命令位於下列範圍：**環境**，**階層**，和**文件**。 知道每個範圍，才能有信心命令位置中。  
  
 中的命令**環境**範圍建立主要的內容和多個內容間共用。 會修改可見性或文件和工具視窗的排列方式。 在環境中的命令範圍，其中包括**新專案**，**連接到伺服器**，**附加處理序**，**剪下**， **複製**，**貼上**，**尋找**，**選項**，**自訂**，**新視窗**，和**檢視說明**。  
  
 中的命令**階層**範圍管理在 Visual Studio 包括階層**專案**，**小組**，和**資料**。 比方說，關聯到專案的子內容-**偵錯**，**建置**，**測試**，**架構**，或**分析**. 在階層中的命令範圍，其中包括**加入新項目**，**新查詢**，**專案設定**，**加入新資料來源**， **啟動效能精靈**，和**新圖表**。  
  
 中的命令**文件**內容的文件，例如程式碼、 設計或工作項目查詢 (WIQ) 範圍處理。 它們也操作工具視窗的檢視，或所特有的工具視窗。 文件範圍命令也處理其本身階層特有的例如檔案物件**從專案移除**。 文件中的命令範圍，其中包括**重構 > 重新命名**，**建立工作項目的複本**，**全部展開**，**全部摺疊**，和**建立使用者工作**。  
  
### <a name="command-placement-decisions"></a>命令位置決策  
 之後您已經決定要建立命令，您需要判斷其適當的放置位置，以及是否要建立鍵盤快速鍵。 請遵循此決策路徑，來建立放置命令的位置：  
  
 ![命令位置決策圖](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501 a_CommandPlacement")  
  
 **在 Visual Studio 中的命令位置決策路徑**  
  
### <a name="command-placement-in-menus"></a>命令功能表中的位置  
  
#### <a name="main-menu-bar"></a>主功能表列  
 主功能表列應該是任何特定內容相關功能表封裝構成 UI 的命令的標準位置。 主功能表列與其他命令結構的環境會使用它來控制哪些命令會顯示。 所有其他的命令列只需要停用命令，不在內容中，它們被放在功能表或工具列上。  
  
 環境定義主功能表列內建的命令，在整個 IDE 與工作的多個網域之間是通用的一的組。 這些命令會永遠顯示無論如何都 Vspackage 會載入至環境。 雖然 Vspackage 可以擴充此組命令，從每個產品以及其命令位置來設定此命令會為每個小組的責任。  
  
 Visual Studio 主功能表的結構可以分成下列功能表類別：  
  
##### <a name="core-menus"></a>核心功能表  
  
-   檔案  
  
-   編輯  
  
-   檢視  
  
-   工具  
  
-   視窗  
  
-   說明  
  
##### <a name="project-specific-menus"></a>專案特定功能表  
  
-   專案  
  
-   組建  
  
-   偵錯  
  
##### <a name="context-specific-menus"></a>特定的內容功能表  
  
-   小組  
  
-   資料  
  
-   測試  
  
-   架構  
  
-   分析  
  
##### <a name="document-specific-menus"></a>文件特有的功能表  
  
-   格式  
  
-   資料表  
  
##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>在設計主功能表時，遵循這些規則：  
  
-   不能超過 25 個最上層的項目中指定的內容  
  
-   功能表應該永遠不會超過 600 像素的高度。  
  
-   Ultimate SKU 和一般設定檔中，例如評估多個內容，在主功能表。  
  
-   彈出式視窗功能表可接受的。  
  
-   彈出式視窗功能表應該包含至少三個項目和不超過七個。  
  
-   彈出式視窗功能表應該只有一個層級深度-有些 Visual Studio 的功能表項目具有階層式子功能表，但不是鼓勵這種模式。  
  
-   使用六個以上的分隔符號。 群組應該遵守下圖：  
  
     ![主功能表群組的指導方針](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501 b_MainMenus")  
  
-   雖然不需要有每個群組，在此圖中，加入其他群組會受到限制。  
  
-   每個群組應該有二到七個功能表項目。  
  
#### <a name="main-menu-ordering"></a>主功能表排序  
 然後再加入新的最上層項目，請考慮將命令放在現有的最上層功能表。 當加入新的最上層功能表，請務必將它放在正確的位置。 決定是否專案、 內容或文件的特定功能表。 保持簡潔的最上層的功能表名稱，並使用只有一個單字。  
  
 核心功能表應該書夾其餘的命令。 檔案、 編輯和檢視應該一律是向左及工具 視窗中，並說明應該一律是右邊。  
  
#### <a name="context-menus"></a>操作功能表  
 將太多的快顯功能表中的功能會導致難以學習的介面。 所有的主要功能應該是可透過主功能表列。 位置的命令應該與現有的命令，以避免重複的命令一致。 內容功能表的殼層定義應該根據的方案、 專案節點或專案項目操作功能表是否納入標準功能表群組。  
  
 在設計操作功能表時，遵循相同的規則與主功能表中，並另外：  
  
-   不超過 25 個最上層功能表項目。  
  
-   彈出式視窗功能表是可接受，但必須不能超過一層的深度-永遠不會使用階層式的延伸顯示。  
  
-   使用六個以上的分隔符號。  
  
### <a name="command-placement-in-toolbars"></a>在工具列中的命令位置  
  
#### <a name="general-toolbars"></a>一般工具列  
 在設計和排列工具列，請遵循這些標準：  
  
-   請勿使用一個以上的動詞命令，每個按鈕。 其中一個按鈕 = 一個動作。  
  
-   只有在需要以可加強的標籤，請使用圖示旁的文字。  
  
-   使用專用的屬性，將會在一個工作階段中多次切換的下拉式方塊。 否則，公開其他位置的屬性。  
  
-   下拉式方塊的寬度應該會等於最長的項目內的方塊加上 30%的寬度。 比方說，如果最長的項目是 200 像素為單位，則下拉式方塊應為 260 個像素寬。  
  
-   限制使用分隔符號。 分隔符號旁邊的下拉式清單中的使用是反向的模式，因為本身下拉式清單中的圖形做為視覺分隔符號。  
  
-   圖示群組應該包含介於 3 到 6 個圖示。  
  
-   如果限定詞產生多個有用的命令，使用分割按鈕儲存最後的設定：  
  
     ![Visual Studio 中的分割按鈕](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501 c_SplitButtons")  
  
     **分割按鈕的範例。在左邊的六個命令可以改為納入單一按鈕。**  
  
#### <a name="product-specific-toolbars"></a>特定產品的工具列  
 每個產品可以提供包含常用的預設工具列和重要命令，以及每個產品預設工具列應該會出現在已安裝產品啟動 Visual Studio 的第一次。  
  
 共用的命令群組與 IDE 所提供的功能表，也應該運用產品。 每個共用的命令群組放置在共用功能表，用於使用者有意義的方式組織相關的命令。 請務必利用這個共用的命令結構，以降低複雜性。  
  
#### <a name="global-toolbars"></a>通用工具列  
 需要符合現成的一個資料列右側的全域工具列。 在建立新的全域工具列時，請遵循該工具列類型的指導方針。  
  
 **一般工具列指導方針：**  
  
-   每個工具列通用控制項 （「 移駐夾 」、 「 溢出 」） 中有 24 像素為單位。  
  
-   每個工具列按鈕是 22 個像素寬包含邊框間距。 讓分割按鈕的圖示加入另一個 11 像素為單位的寬度。  
  
-   允許重複的工具列上的命令。  
  
 **特定文件的工具列**特定檔案類型為作用中時，會出現，而且不同的檔案類型會變成作用中時會消失。  
  
-   特定文件的工具列不能有 12 個以上的按鈕。  
  
-   工具列的寬度總計不可能超過 300 像素為單位。  
  
-   每個檔案類型可以有一個內嵌的工具列或一個特定文件的全域工具列上，但非兩者。  
  
 **內容特定工具列**出現時的特定內容是設定，而且通常會保持作用中長時間。  
  
-   所有的內容專用工具列按鈕限制為 18。  
  
-   如果使用內容時，大部分使用者將不會以一致的方式會採用這個工具列命令，將不產生關聯此工具列的內容。  
  
-   請確定工具列在結束內容時就會消失。 沒有任何這些工具列應該會出現在啟動。  
  
 **無內容工具列**永遠不會自動出現。 這些顯示只有當使用者啟動它們。 保留以下 200 像素為單位的最大寬度。  
  
### <a name="general-organization-and-shell-defined-groups"></a>一般的組織和介面定義的群組  
 使用現有的共用的命令、 命令群組和功能表。 如果需要定義新的命令，請將它放在現有的共用的命令群組。 如果需要定義新的群組，請將它放在現有的共用接近相關的命令群組功能表中，建立新的最上層功能表之前。 這可降低命令複雜性，同時確保一致的命令位置，在 IDE 中。  
  
 共用**格式**在下圖說明功能表上，通常會顯示在設計工具樣式的文件視窗的內容中：  
  
 ![包含圖說文字的 visual Studio 格式功能表](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501 d_FormatMenu")  
  
 **在 Visual Studio 中的功能表群組**  
  
### <a name="reducing-and-reusing-commands"></a>減少與重複使用的命令  
 命令是通常根據上顯示的內容中，以減少使用者會看到任何給定時間的命令數目。 不過，您也應該重複使用現有的共用的功能表和命令群組，以確保命令結構保持相當靜態內容中的變更之間。  
  
 重複使用共用的命令，並將新接近共用的相關命令的命令可降低複雜性 IDE，並建立更方便使用的經驗。  
  
## <a name="naming-commands"></a>命名命令  
  
### <a name="naming-conventions"></a>命名規範  
 命名一致的命令很重要，讓使用者可以尋找並執行命令，可以使用命令列或繫結到鍵盤快速鍵。 命令名稱也會協助使用者了解哪些命令做時它會顯示在工具列上，或在階層式或內容功能表中的用途。  
  
#### <a name="when-naming-commands"></a>當命令命名：  
  
-   建構文字，這樣便可輕鬆地當地語系化。 如需詳細資訊當地語系化文字，請參閱[for Visual Studio 的世界整備](http://msdn.microsoft.com/en-us/1cc35051-8126-441f-bea9-059245a47b1d)。  
  
-   很簡潔。 命令應該使用三個以上的字。  
  
-   使用字首大寫的大小寫： 每個單字的第一個字母都必須大寫。 如需 Visual Studio 中的格式化文字的詳細資訊，請參閱[文字樣式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。  
  
-   請考量將放置命令。 它是否在最上層的功能表或延伸？ 比方說，當群組對齊指令彈出式視窗，而最上層命令中的應該是 「 對齊 」 以及彈出式視窗的命令應該是"Left"「 右 」、"Center，""Justify"，等等。 必要命名彈出式視窗命令"靠左對齊"或"Right Align"。  
  
     ![Visual Studio 的 [格式] 功能表](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502 a_FormatMenu")  
  
### <a name="using-icons-with-commands"></a>使用命令圖示  
 謹慎地圖示配對指令的使用中。 將唯一的映像與命令相關聯 hastens 識別該命令的使用者的能力，雖然 visual 混亂的情形和效率不彰發生映像過度使用。 下列規則，協助決定是否要建立命令圖示時。  
  
#### <a name="use-an-icon-with-a-command-only-if"></a>使用命令才圖示：  
  
-   在同一個命令會有另一個明顯 Microsoft 產品中，例如其中一個 Microsoft Office 應用程式與它相關聯的圖示。  
  
-   此命令會放在預設工具列。  
  
-   命令是特殊命令的使用者可能會加入至工具列，使用**[自訂]**對話方塊。  
  
## <a name="access-and-shortcut-keys"></a>存取和快速鍵  
  
### <a name="overview"></a>總覽  
 有兩種類型的鍵盤按鍵：  
  
-   **存取金鑰**（也稱為快速鍵） 允許在對話方塊的 UI 中使用鍵盤存取透過功能表命令以及每個標籤。 便捷鍵主要是供協助工具、 指派給所有功能表和大部分對話方塊控制項，不是所要的記憶中，會影響只有目前的視窗，而且會當地語系化。  
  
-   **攠摝坫**大部分使用控制項 (Ctrl) 和函式 (Fn) 索引鍵的序列。 它們被設計進階的使用者，並且有助於提升的生產力。 它們只能指派給最常用的命令，並允許快速存取，同時略過主功能表。 快速鍵要所記憶時，而且該原因必須指派與設定檔結構描述一致。 快速鍵金鑰配置可能會不同設定檔。 使用者可以自訂快捷鍵透過**工具 > 選項 > 鍵盤**。  
  
### <a name="assigning-access-keys"></a>指定便捷鍵  
 便捷鍵 Alt 再加上英數字元的索引鍵所組成。 指定便捷鍵至每個功能表項目，而沒有例外狀況。 請遵循 Windows 和一般慣例指定便捷鍵。 例如的存取金鑰**檔案 > 新增**應一律**alt 鍵，F N**。  
  
 請勿使用單一像素寬度字母，例如 'i' （以大寫或小寫） 或小寫 'l'，並且避免容納 （g、 j、 p、 q 和 y） 搭配使用的字元，因為這些是難以區別。  
  
 請避免使用時可能重複的索引鍵。 無可避免重複的情況下，功能表系統衝突處理方式以輪流使用金鑰的所有命令。 例如，假設 「 數字 」 命令重複"N"便捷鍵的 [檔案] 功能表底下的**alt 鍵，F，N**會建立新的檔案，和**Alt、 F、 N、 N**會執行 「 數字 」 命令。  
  
### <a name="assigning-shortcut-keys"></a>指派攠摝坫  
 請避免將新的快速鍵，因為它們並不需要每個命令中，如果過度使用而使稅系統 （和使用者記憶體）。 資料從客戶經驗改進計畫 (CEIP) 會指出 Visual Studio 使用者使用整合式快速鍵一小部分。  
  
 在定義的捷徑，請遵循下列規則：  
  
-   **使用控制項 (Ctrl) 和函式 (Fn) 索引鍵的序列。**  
  
-   **保留常用的快速鍵。** 維護最受歡迎的快速鍵。  
  
-   **讓編輯器快速鍵容易輸入。** 將簡單類型快速鍵繫結至開發人員必須撰寫程式碼時的大部分命令。 比方說， **Edit.InvokeSmartTag**必須有快速快速鍵，例如 Ctrl + 並沒有 Alt + Shift + F10。  
  
-   **盡可能一致地佈景主題的捷徑。**  
  
-   **遵循 Windows 指導方針來判斷哪些修飾詞的索引鍵使用。** 使用 ctrl 鍵組合之命令的大規模的效果，例如，套用至整份文件的命令。 擴充或補充標準快速鍵的動作的命令，請使用 Shift 鍵組合。 不要使用 Ctrl + alt 鍵組合。  
  
-   **移除多餘的捷徑。** 如果您有舊版的功能，請考慮移除捷徑時，所使用極端 infrequency （少於 10 次從 CEIP 資料） 或中度 infrequency （少於 100 次從 CEIP 資料） 的存取金鑰提供快速存取相同的命令。 例如： alt 鍵，H，C 會開啟說明/內容。  
  
 不是簡單的方式來檢查捷徑可用性。 如果您想要加入捷徑，請遵循下列步驟：  
  
1.  檢查清單[Visual Studio 2013 快速鍵](http://visualstudioshortcuts.com/2013/)來判斷是否有類似的命令群組與您自己。  
  
2.  移至**工具 > 選項 > 環境 > 鍵盤**和測試您的捷徑。 檢查每個鍵盤對應配置列在 「 套用下列其他鍵盤對應配置 」。 檢查一般、 C#、 VB 和 c + + 設定檔，因為這些共用唯一的快速鍵。 如果它並未對應任一這些地方使用您的捷徑。