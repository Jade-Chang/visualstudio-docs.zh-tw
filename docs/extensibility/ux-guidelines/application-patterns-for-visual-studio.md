---
title: 應用程式模式適用於 Visual Studio |Microsoft 文件
ms.custom: ''
ms.date: 04/26/2017
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: a793651660c456213c0e91c0d6c6474cccf3f7d8
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/16/2018
---
# <a name="application-patterns-for-visual-studio"></a>Visual Studio 的應用程式模式
##  <a name="BKMK_WindowInteractions"></a> 視窗互動  
  
### <a name="overview"></a>總覽  
使用 Visual Studio 中的兩個主要視窗型別是文件編輯器和工具視窗。 少見，但可能，是大型的非強制回應對話方塊。 雖然這些是在介面中所有非強制回應，但是其模式是本質上不同。 本章節涵蓋文件視窗中，工具視窗和非強制回應對話方塊的差異。 強制回應對話方塊模式將會涵蓋[對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)。  
  
### <a name="comparing-window-usage-patterns"></a>比較視窗使用模式  
**文件視窗**幾乎文件中也顯示。 這可讓文件編輯器 」 置階段 「 若要排列周圍的補充工具視窗。  
  
A**工具視窗**通常會顯示為針對 IDE 邊緣摺疊的個別較小視窗。 這可以是可見、 隱藏或自動隱藏。 不過，有時候工具視窗提出內文件區域，以取消核取**停駐視窗/** 視窗上的屬性。 這會導致多個項目，但一般也設計決策： 嘗試時將整合到 Visual Studio，您必須決定您的功能是否應顯示的工具視窗或文件視窗。  
  
**非強制回應對話方塊**會建議您不要在 Visual Studio。 最非強制回應對話方塊，根據定義，浮動工具視窗，並應該實作該方法。 在其中一般工具視窗停駐於殼層的側邊的大小會限制太大的情況下允許非強制回應對話方塊。 它們也可在其中使用者會將對話方塊移至第二個監視器可能的情況下。  
  
將您所需要的容器類型的相關仔細。 常見的使用方式模式考量，如 UI 設計是下表中。  
  
||文件視窗|工具視窗|非強制回應對話方塊|  
|-|---------------------|-----------------|---------------------|  
| **位置** | 一律也放在文件中並不會不停駐在 IDE 邊緣。 它可以是 「 提取 」，以便個別浮動從主要介面。 | 一般索引標籤-停駐在 IDE 中邊緣，但可以是自訂浮動、 自動隱藏 （不固定），或也停駐在文件中。|大型浮動視窗分開 IDE。 |  
| **認可模型** | *延遲的認可*<br /><br /> 若要將資料儲存在文件中，使用者必須發出**檔案&gt;儲存**，**存**，或**全部儲存**命令。 文件視窗有再認可至其中一個儲存的資料都正在 「 變更 」 概念命令。 當關閉文件視窗，所有內容都儲存至磁碟或遺失。 | *立即認可*<br /><br /> 沒有任何儲存模型。 Inspector 工具視窗可協助您編輯檔案，檔案必須在使用中編輯器或設計工具中，開啟並編輯器或設計工具擁有儲存。 | *延遲或立即認可*<br /><br /> 大多數情況下，大型的非強制回應對話方塊需要動作，以認可變更，並允許 「 取消 」 作業，會回復任何對話工作階段中所做的變更。  這項會區別從工具視窗的非強制回應對話方塊，工具視窗一律會有未立即認可模型。 |  
| **可見度** | *開啟/建立 （檔案） 和 關閉*<br /><br /> 開啟文件視窗是透過開啟現有文件，或是使用範本建立新的文件。 沒有任何 「 開啟\<特定編輯器 >"命令。 | *隱藏和顯示*<br /><br /> 單一執行個體工具視窗可以隱藏或顯示。 內容和工具視窗內的狀態保存是否在檢視或隱藏。 多個執行個體工具視窗可以被關閉，以及隱藏。 多個執行個體工具視窗關閉時，內容和工具視窗中的狀態會被捨棄。 | *從命令啟動*<br /><br /> 對話方塊會啟動工作為基礎的命令。 |  
| **執行個體** | *多個執行個體*<br /><br /> 某些編輯器也可讓多個編輯器中開啟相同的檔案，數個編輯器可同時開啟相同的時間和編輯不同的檔案 (使用**視窗&gt;新視窗**命令)。<br /><br /> 單一編輯器可能編輯一個或多個檔案在相同的時間 （專案設計工具）。 | *單一或多重 instance*<br /><br /> 內容變更以反映內容 （如同在屬性瀏覽器），或將焦點/內容推送到其他視窗 （方案總管 中的 工作清單）。<br /><br /> 除非有充足的理由不為單一執行個體和多重執行個體工具視窗應該與主動式文件視窗產生關聯。 | *單一執行個體* |  
| **範例** | **文字編輯器**，例如程式碼編輯器<br /><br /> **設計介面**： 如表單設計工具或模型介面<br /><br /> **控制配置給對話方塊類似**，例如資訊清單設計工具 | **方案總管 中**提供方案和專案包含方案中<br /><br /> **伺服器總管**提供的伺服器和資料連接的使用者選擇要開啟的視窗階層式檢視。 從資料庫，在階層的查詢中，開啟物件時，會開啟文件視窗，並可讓使用者編輯查詢。<br /><br /> **屬性瀏覽器**會顯示在文件視窗或另一個工具視窗中所選物件的屬性。 屬性會出現在方格的階層式檢視中，或在類似對話方塊的複雜控制項中，而讓使用者設定這些屬性的值。 | |  
  
##  <a name="BKMK_ToolWindows"></a> 工具視窗  
  
### <a name="overview"></a>總覽  
工具視窗支援文件視窗中發生的使用者的工作。 它們可以用來顯示代表 Visual Studio 提供，且可以操作的基本根物件的階層。  
  
當考量新的工具視窗在 IDE 中，作者應該：  
  
-   使用適當的工作現有的工具視窗，並建立新的具有類似功能。 如果他們提供完全不同的 [工具] 或類似的視窗中，或藉由開啟現有的視窗到樞紐中心無法整合的功能，才應該建立新的工具視窗。  
  
-   如有需要在 [工具] 視窗的頂端，請使用標準命令列。  
  
-   要與其他工具視窗中控制項的呈現與鍵盤巡覽已有模式一致。  
  
-   要與其他工具視窗中的控制簡報一致。  
  
-   顯示特定文件的工具視窗自動-如果可能的話，使其只在啟用的父文件時才會顯示。  
  
-   請確定其視窗內容是可瀏覽由鍵盤 （支援方向鍵）。  
  
#### <a name="tool-window-states"></a>工具視窗狀態  
Visual Studio 工具視窗有不同的狀態，其中有些是使用者啟動 （例如 「 自動隱藏 」 功能）。 其他狀態時，自動顯示，允許在正確內容中顯示和隱藏時不需要的工具視窗。 總共有五個工具視窗狀態。  
  
-   **停駐/釘選**可附加至任何文件區域四邊的工具視窗。 圖釘圖示會出現在工具視窗標題列。 工具視窗可以停駐水平或垂直邊緣殼層和其他工具視窗，並也可以被標籤連結。  
  
-   **自動隱藏**工具視窗是已取消固定。 視窗可以使，離開 （使用 [工具] 視窗和圖示的名稱） 的索引標籤上的文件區域邊緣滑動。 工具視窗滑出，當使用者將滑鼠停留在索引標籤上。  
  
-   **自動可見**工具視窗會自動出現時的編輯器等另一張 UI，就會啟動，或是取得焦點。  
  
-   **浮點**工具視窗將滑鼠停留在 IDE 之外。 這可用於多重監視器組態。  
  
-   **索引標籤式文件**工具視窗可以停駐在文件中也。 這是框架的適用於大型的工具視窗，例如物件瀏覽器需要多個不動產比停駐邊緣所允許的。  
  
![工具視窗狀態，在 Visual Studio 中的](../../extensibility/ux-guidelines/media/0702-01_toolwindowstates.png "0702年 01_ToolWindowStates")<br />Visual Studio 中的工具視窗狀態
  
#### <a name="single-instance-and-multi-instance"></a>單一執行個體和多重執行個體  
工具視窗是單一執行個體或多重執行個體。 多重執行個體工具視窗不可能時，部分的單一執行個體工具視窗可能主動式文件視窗中，與相關聯。 多個執行個體工具視窗回應**視窗&gt;新視窗**命令藉由建立視窗的新執行個體。 下圖顯示工具視窗，讓新視窗 命令，使用中視窗的執行個體時：  
  
![啟用視窗的執行個體時，[新視窗] 命令的工具視窗是作用中](../../extensibility/ux-guidelines/media/0702-02_toolwindowenablingcommand.png "0702年 02_ToolWindowEnablingCommand")<br />啟用視窗的執行個體時，[新視窗] 命令的工具視窗是作用中  
  
單一執行個體工具視窗可以隱藏或顯示，而多個執行個體工具視窗可以被關閉，以及隱藏。 所有工具視窗可以停都駐，標籤連結、 浮動或設為多重文件介面 (MDI) 子視窗 （類似於文件視窗）。 所有工具視窗應該都回應 [視窗] 功能表中的適當視窗管理命令：  
  
![在 Visual Studio 視窗功能表的視窗管理命令](../../extensibility/ux-guidelines/media/0702-03_windowmanagementcontrols.png "0702年 03_WindowManagementControls")<br />在 Visual Studio 視窗功能表的視窗管理命令
  
#### <a name="document-specific-tool-windows"></a>特定文件的工具視窗  
部分工具視窗的設計會依據給定的文件類型而變更。 這些視窗持續更新以反映適用於使用中的文件視窗在 IDE 中的功能。  
  
工具視窗的內容變更以反映選取的編輯器範例為 [工具箱] 和文件大綱。 當編輯器具有焦點無法提供內容至視窗時，這些視窗會顯示為浮水印。  
  
#### <a name="navigable-list-tool-windows"></a>可瀏覽清單工具視窗  
部分工具視窗來顯示使用者可以互動的可導覽項目的清單。 在這種類型的視窗中，永遠應該有意見反應為目前的項目在清單中，即使非使用中視窗。 清單應該回應**GoToNextLocation**和**GoToPrevLocation**也變更視窗中目前選取的項目命令  
  
可瀏覽清單工具視窗的範例包括 [方案總管] 和 [尋找結果] 視窗。  
  
### <a name="tool-window-types"></a>工具視窗類型  
  
#### <a name="common-tool-windows-and-their-functions"></a>通用工具視窗和其函式

**階層工具視窗**
| 工具視窗 | 功能 | 
| --- | --- | 
| 底下提供說明，包括方案總管 | 顯示一份文件以階層樹狀結構會包含在專案、 其他檔案和方案項目。 顯示專案中的項目是由封裝擁有專案類型 （例如，參考為基礎、 目錄為基礎，或混合模式類型） 所定義的。 | 
| 類別檢視 | 類別和文件，檔案本身的獨立工作集中的各種元素的階層式樹狀結構。 | 
| 伺服器總管 | 階層式樹狀結構顯示在方案中的所有伺服器和資料連接。 | 
| 文件大綱 | 使用中文件的階層式結構。 | 

**方格工具視窗**
| 工具視窗 | 功能 | 
| --- | --- | 
| 屬性 | 方格會顯示一份所選的物件，以及編輯這些屬性的值選擇器的屬性。 | 
| 工作清單 | 可讓使用者建立/編輯/刪除工作和註解方格。 | 

**內容的工具視窗**
| 工具視窗 | 功能 | 
| --- | --- | 
| 說明 | 視窗，可讓使用者存取各種方法的說明，請從 「 如何？ 」 系列 視訊至 MSDN 論壇。 | 
| 動態說明 | 工具視窗顯示說明主題適用於目前的選取範圍的連結。 | 
| 物件瀏覽器 | 兩個資料行框架組的左的窗格中的物件屬性的階層式物件元件和右欄中的方法清單。 | 

**對話方塊工具視窗**
| 工具視窗 | 功能 | 
| --- | --- | 
| Find | 一個對話方塊，可讓使用者尋找或尋找及取代方案內的各種檔案中。 |
| 進階的尋找 | 一個對話方塊，可讓使用者尋找或尋找及取代方案內的各種檔案中。 | 

**其他工具視窗**
| 工具視窗 | 功能 | 
| --- | --- | 
| 工具箱 | 工具視窗用來儲存要卸除到設計介面，提供一致的拖曳來源的所有設計工具上的項目。 |
| 起始頁 | 使用者入口網站 Visual Studio 中，以存取摘要的開發人員的新聞、 Visual Studio 說明和最近使用的專案。 使用者也可以藉由複製的 StartPage.xaml 檔案建立自訂起始頁 」 Common7\IDE\StartPages\" StartPages 資料夾，Visual Studio 中的 Visual Studio program files 目錄文件的目錄，然後編輯 XAML指針或在 Visual Studio 或其他程式碼編輯器中開啟。 | 

**偵錯工具 工具視窗**
| 工具視窗 | 功能 | 
| --- | --- |
| 自動 ||  
| 即時運算 ||  
| 輸出 | 只要有文字事件或狀態來宣告，可以使用 [輸出] 視窗。 |  
| 記憶體 ||  
| 中斷點 ||  
| 執行中 ||  
| 文件 ||  
| 呼叫堆疊 ||  
| 區域變數 ||  
| 監看式 ||  
| 反組譯碼 ||  
| 暫存器 ||  
| 執行緒 ||  
  
##  <a name="BKMK_DocumentEditorConventions"></a> 文件編輯器慣例  
  
### <a name="document-interactions"></a>文件的互動  
「 文件格式 」 是在 IDE 中的最大空間，其中使用者通常著重注意若要完成其工作，補充的工具視窗的輔助。 文件編輯器代表工作的使用者開啟並儲存在 Visual Studio 中的基本單位。 它們會保留的強式的意義上，繫結至 [方案總管] 或其他使用中的階層架構視窗選取範圍。 使用者應該能夠指向其中一個這些階層視窗並且知道所在文件和其關聯性的方案、 專案或 Visual Studio 封裝所提供的另一個根物件。  
  
文件編輯需要一致的使用者體驗。 若要讓使用者將焦點放在手邊的工作而不是視窗管理和尋找命令上，選取最適合進行編輯的文件類型的使用者工作的文件檢視策略。  
  
#### <a name="common-interactions-for-the-document-well"></a>常見的互動方式，以及文件  
  
-   維護一致的互動中的模型一般**新檔案**和**開啟檔案**體驗。  
  
-   當文件視窗開啟時，請更新相關的視窗和功能表中的相關的功能。  
  
-   功能表命令已適當地整合到類似的一般功能表**編輯**，**格式**，和**檢視**功能表。 如果有大量的特製化的命令，可以建立新的功能表。 只有當文件具有焦點時，應該會顯示這個新的功能表。  
  
-   內嵌的工具列，可能會放在編輯器的頂端。 這是具有不同的工具列，會顯示在編輯器之外。  
  
-   永遠維持在 [方案總管] 或類似的作用中的選取項目階層架構視窗。  
  
-   按兩下 [方案總管] 中的文件，則應該執行相同的動作**開啟**。  
  
-   如果多個編輯器可以用文件類型上，使用者應該能夠覆寫或重設使用給定文件類型的預設動作**開啟**檔案上按一下滑鼠右鍵，然後選取對話方塊**開啟與**從捷徑功能表。  
  
-   也不用建置文件中的精靈。  
  
### <a name="user-expectations-for-specific-document-types"></a>使用者期望的特定文件類型  
有數個不同的基本類型的文件編輯器，而且各有一組與相同類型的其他人一致的互動。  
  
-   **以文字為基礎的編輯器：**程式碼編輯器、 記錄檔  
  
-   **設計介面：** WPF 表單設計工具，Windows form  
  
-   **對話方塊樣式編輯器：**資訊清單設計工具中，專案屬性  
  
-   **模型設計師：**工作流程設計工具、 codemap、 架構圖、 進度  
  
另外還有數個使用文件的非編輯器類型。 他們不編輯文件本身，而它們就需要遵循標準文件視窗的互動。  
  
-   **報告：** IntelliTrace 報告，請為 HYPER-V 報表，分析工具報告  
  
-   **儀表板：**診斷中樞  
  
#### <a name="text-based-editors"></a>以文字為基礎的編輯器  
  
-   文件參與預覽索引標籤模型，以便預覽文件，而不開啟它。  
  
-   文件結構可能會表示附屬工具視窗，例如文件大綱內。  
  
-   IntelliSense （適當的話） 會有一致的行為與其他程式碼編輯器。  
  
-   快顯視窗或輔助 UI 遵循類似的樣式和模式的現有類似的 UI，例如 CodeLens。  
  
-   在資訊列控制項上方的文件中或在 [狀態] 列中，系統會提供有關文件狀態訊息。  
  
-   使用者必須能夠自訂字型和色彩使用的外觀**工具 > 選項**頁面上，共用的字型和色彩頁面或一個特定的編輯器。  
  
#### <a name="design-surfaces"></a>設計介面  
  
-   空的設計工具應該指出如何開始在介面上浮水印。  
  
-   檢視切換機制將會遵循現有的模式，例如按兩下以開啟程式碼編輯器中或允許這兩個窗格互動的文件視窗內的索引標籤。  
  
-   將項目加入至設計介面應透過完成 [工具箱] 中，除非需要非常特定的工具視窗。  
  
-   在介面上的項目將會遵循一致的選取範圍模型。  
  
-   包含文件特有的命令，不是常見的命令，例如內嵌的工具列**儲存**。  
  
#### <a name="dialog-style-editors"></a>對話方塊樣式編輯器  
  
-   控制項配置應該遵循一般的對話方塊版面配置慣例。  
  
-   在編輯器中的索引標籤不應符合文件索引標籤的外觀，其應符合兩個允許的內部索引標籤樣式的其中一個。  
  
-   使用者必須能夠與使用鍵盤; 僅限控制項互動請啟動編輯器 中並按下 tab 鍵透過控制項，或使用標準的助憶鍵。  
  
-   在設計工具應該使用儲存模式一般。 沒有整體儲存 或 認可 按鈕應該放在介面中，雖然其他按鈕，可能適合。  
  
#### <a name="model-designers"></a>模型設計工具  
  
-   空的設計工具應該指出如何開始在介面上浮水印。  
  
-   將項目加入至設計介面應該透過 [工具箱]。  
  
-   在介面上的項目將會遵循一致的選取範圍模型。  
  
-   包含文件特有的命令，不是常見的命令，例如內嵌的工具列**儲存**。  
  
-   圖例可能會出現在介面中，為表示或浮水印。  
  
-   使用者必須能夠使用的字型/色彩訂**工具 > 選項**頁面上，共用的字型和色彩頁面或一個特定的編輯器。  
  
#### <a name="reports"></a>報告  
  
-   報表必須使用一般資訊和不參與儲存模型。 不過，它們可能會包含互動功能，例如連結至其他相關資訊或展開和摺疊的章節。  
  
-   在介面上的大部分命令應該是超連結，而不是按鈕。  
  
-   版面配置應該包含標頭，並遵循標準報表的版面配置指導方針。  
  
#### <a name="dashboards"></a>儀表板  
  
-   儀表板沒有互動模型本身，但是做為提供各種不同的其他工具的方法。  
  
-   它們不會參與儲存模型。  
  
-   使用者必須能夠與使用鍵盤，啟動編輯器 中，並按 tab 鍵經過控制項或使用標準的助憶鍵控制項互動。  
  
##  <a name="BKMK_Dialogs"></a> 對話方塊  
  
### <a name="introduction"></a>簡介  
在 Visual Studio 中的對話方塊通常應該支援的使用者工作的一不連續單位，然後關閉。  
  
如果您決定您需要一個對話方塊，您會有三個選項，喜好設定順序：  
  
1.  將功能整合成一個 Visual Studio 中的 [共用] 對話方塊。  
  
2.  建立您自己的對話方塊使用現有的類似對話中找到的模式。  
  
3.  建立新的對話方塊中，下列互動和版面配置的指導方針。  
  
本章節描述如何選擇正確的對話方塊模式，在 Visual Studio 工作流程和設計對話方塊的常見慣例。  
  
### <a name="themes"></a>主題  
在 Visual Studio 中的對話方塊，請依照下列兩個基本樣式的其中一個：  
  
#### <a name="standard-unthemed"></a>標準 (unthemed)  
對話的多數標準公用程式對話方塊因此應該 unthemed。 請勿不 re 範本通用控制項，或嘗試建立樣式化的 「 現代化 」 按鈕或控制項。 控制項和 chrome 外觀遵循[對話方塊標準的 Windows 桌面互動方針](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742499\(v=vs.85\).aspx)。  
  
#### <a name="themed"></a>佈景主題  
Specialty 「 簽章 」 對話方塊可能已設定佈景主題。 佈景主題對話方塊會有不同的外觀，也有一些特殊的互動模式中相關聯的樣式。 佈景主題您只有在符合這些需求的對話方塊：  
  
-   對話是常見的體驗將會看到及通常或多位使用者使用 (例如，**新專案**對話方塊。  
  
-   此對話方塊包含的顯著產品品牌項目 (例如，**帳戶設定**對話方塊)。  
  
-   對話方塊會顯示為較大的流程，其中包含其他佈景主題的對話方塊中不可或缺的一部分 (例如，**加入已連接服務**對話方塊)。  
  
-   對話是經驗的策略在扮演的角色升級，或可區分針對產品版本很重要的一部分。  
  
在建立佈景主題對話方塊時，使用適當的環境色彩，並遵循正確的版面配置和互動模式。 (請參閱[for Visual Studio 的版面配置](../../extensibility/ux-guidelines/layout-for-visual-studio.md)。)  
  
### <a name="dialog-design"></a>設計對話方塊  
設計良好的對話方塊會將下列項目納入考量：  
  
-   所支援的使用者工作  
  
-   對話方塊文字樣式、 語言和術語  
  
-   控制項選擇與 UI 慣例  
  
-   視覺化配置規格和控制項的對齊方式  
  
-   存取鍵盤  
  
#### <a name="content-organization"></a>內容的組織  
請考慮對話的這些基本類型之間的差異：  
  
-   [簡單對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)呈現單一的強制回應視窗中的控制項。 展示檔可能包含複雜的控制項模式，包括欄位選擇器或圖示列的變化。  
  
-   [分層對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)用於充分螢幕面積一 UI 段包含多個群組的控制項時。 對話方塊群組的 「 分層 」 透過索引標籤控制項、 瀏覽清單控制項或按鈕，讓使用者選擇哪一個群組，以查看在任何給定的時刻。  
  
-   [精靈](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)有用來引導使用者進行一連串的步驟朝完成工作的邏輯。 提供一系列選項循序面板，有時也導入不同的工作流程 （「 分支 」） 是在上一個面板中所做的選擇而定。  
  
####  <a name="BKMK_SimpleDialogs"></a> 簡單對話方塊  
簡單對話方塊是單一的強制回應視窗中控制項的呈現。 這個展示檔可能包含複雜的控制項模式，例如欄位選擇器的變化。 簡單的對話，請遵循標準的一般配置，以及任何所需的複雜控制項群組的特定配置。
  
![> 建立強式名稱金鑰是簡單的對話方塊，在 Visual Studio 中的範例。] (../../extensibility/ux-guidelines/media/0704-01_createstrongnamekey.png "0704年 01_CreateStrongNameKey")<br />建立強式名稱金鑰是簡單的對話方塊，在 Visual Studio 中的範例。
  
####  <a name="BKMK_LayeredDialogs"></a> 多層式的對話方塊  
分層的對話方塊包含索引標籤、 儀表板和內嵌的樹狀結構。 它們可用來最大化不動產，當有多個群組的單一 UI 段中提供的控制項。 群組的分層，讓使用者選擇哪一個群組，以查看一次。  
  
在最簡單的情況下，群組之間切換的機制是索引標籤控制項。 沒有可用的多個替代方案。 請參閱 Prioritizing 和圖層如何選擇最適當的樣式。  
  
**工具&gt;選項**對話方塊是使用內嵌的樹狀結構的分層對話方塊的範例：  
  
![工具 > 選項，是 Visual Studio 中的分層對話方塊的範例。] (../../extensibility/ux-guidelines/media/0704-02_toolsoptions.png "0704年 02_ToolsOptions")<br />工具 > 選項，是 Visual Studio 中的分層對話方塊的範例。
  
####  <a name="BKMK_Wizards"></a> 精靈  
精靈會引導使用者已透過邏輯的一連串的步驟中完成工作有用。 循序面板中所提供的一系列選項，使用者必須繼續進行到下每個步驟才能繼續。 一旦有足夠的預設值可供使用，**完成**按鈕啟用。  
  
 強制回應的精靈可用於工作的：  
  
-   包含分支會根據使用者選擇提供給不同的路徑  
  
-   包含兩個步驟，後續的步驟會視先前步驟的使用者輸入的相依性  
  
-   不夠複雜的 UI 應用於說明提供的選擇，以及每個步驟中可能的結果  
  
-   為交易式，需要一組已完成整個認可任何變更之前的步驟  
  
### <a name="common-conventions"></a>一般慣例  
若要達到最佳的設計和使用您的對話方塊的功能，依照這些慣例對話方塊大小、 位置、 標準、 控制項設定和對齊方式、 UI 文字、 標題列、 控制按鈕和存取金鑰。  
  
如需特定配置的指導方針，請參閱[for Visual Studio 的版面配置](../../extensibility/ux-guidelines/layout-for-visual-studio.md)。  
  
#### <a name="size"></a>大小  
對話方塊應該符合最低的 1024 x 768 螢幕解析度，以及初始的對話方塊大小不得超過 900 x 700 像素為單位。 對話方塊可能是可調整大小，但並非必要條件。  
  
有兩個建議可調整大小對話方塊：  
  
1.  最小大小所定義的對話方塊，將控制項集合，而不裁剪，針對最佳化調整來容納合理當地語系化成長。  
  
2.  確認使用者調整大小會保存不同工作階段。 例如，如果使用者縮放成 150% 對話方塊，對話方塊後續啟動會顯示在 150%。  
  
#### <a name="position"></a>位置  
對話方塊會顯示必須在第一次啟動 IDE 置中。 不可調整大小對話方塊的最後一個位置不需要保存，因此會出現在後續啟動上置中。 

對於可調整大小的對話，大小應保存在後續啟動中。 可調整大小的強制回應對話方塊的位置不需要保存。 顯示在 IDE 中置中對齊它們會防止，可能會變更使用者的顯示設定時，無法預期或無法使用的位置中出現的對話方塊。 

可以重新定位的非強制回應對話方塊，使用者的位置應該維持在後續啟動時，可能會經常使用的對話方塊，為較大的工作流程中不可或缺的一部分。  
  
當對話方塊必須產生其他對話方塊時，最上層對話方塊應重疊顯示向右和向下，從父代，讓它的明顯使用者他們已巡覽至新位置。  
  
#### <a name="modality"></a>強制回應性  
正在強制回應表示使用者就必須完成或取消對話方塊，然後再繼續。 強制回應對話方塊封鎖使用者令其無法與環境的其他部分互動，因為功能的工作流程應該盡可能謹慎使用。 當需要獨佔式作業時，Visual Studio 就會有共用的對話，您可以整合到您的功能數目。 如果您必須建立新的對話方塊，請遵循現有的對話的互動模式，具有類似功能。  
  
當使用者需要一次執行兩個活動時，就像**尋找**和**取代**時撰寫新程式碼，對話方塊應該是強制回應，讓使用者可以輕鬆地切換它們。 Visual Studio 通常會使用這類的編輯器支援已連結的工作的工具視窗。  
  
#### <a name="control-configuration"></a>控制組態  
要與 Visual Studio 中執行相同的工作的現有控制項組態一致。  
  
#### <a name="title-bars"></a>標題列  
  
-   標題列中的文字必須反映命令啟動它的名稱。  
  
-   無圖示應該用於對話方塊標題列。 在系統需要的其中一個情況下，使用 Visual Studio 標誌。  
  
-   對話方塊不應該有最小化或最大化按鈕。  
  
-   已被取代的標題列中的 [說明] 按鈕。 不要新增至新的對話方塊。 當它們存在的話時，它們應該啟動說明主題，會在概念上與工作相關。  
  
 ![在 Visual Studio 對話方塊中的標題列的指導方針規格](../../extensibility/ux-guidelines/media/0704-03_titlebarspecs.png "0704年 03_TitleBarSpecs")<br />在 Visual Studio 對話方塊中的標題列的指導方針規格
  
#### <a name="control-buttons"></a>控制項的按鈕  
一般情況下，**確定**，**取消**，和**協助**應該水平排列按鈕，在對話方塊右下角。 如果對話方塊有數個其他按鈕會呈現 visual 混淆在一起的控制按鈕的對話方塊底部，允許替代垂直堆疊。  
  
![在 Visual Studio 對話方塊中的控制按鈕的可接受組態](../../extensibility/ux-guidelines/media/0704-04_controlbuttonconfig.png "0704年 04_ControlButtonConfig")<br />可接受在 Visual Studio 對話方塊中的控制項按鈕組態
  
對話方塊中，必須加入預設控制項按鈕。 若要判斷最佳的命令為預設值使用，請選擇下列選項 （依照優先順序列出）：  
  
-   選擇最簡單且最安全的命令做為預設值。 這表示選擇最有可能避免資料遺失且避免非預期的系統存取的命令。  
  
-   如果資料遺失和安全性不因素，然後選擇 便利性為基礎的預設命令。 對話方塊支援經常或重複的工作時，包括最可能的命令為預設值將會提高使用者的工作流程。  
  
避免選擇的預設命令的永久破壞性動作。 如果存在這類命令，請改為做為預設選擇更安全的命令。  
  
#### <a name="access-keys"></a>便捷鍵  
請勿使用便捷鍵**確定**，**取消**，或**協助**按鈕。 根據預設，這些按鈕會對應至快速鍵：  
  
| 按鈕名稱 | 鍵盤快速鍵 |  
| --- | --- |  
| 確定 | Enter |  
| 取消 | Esc |  
| 說明 | F1 |  
  
#### <a name="imagery"></a>圖像  
在對話方塊中，謹慎地使用映像。 不使用大圖示 對話方塊中只使用空間。 使用映像，才會傳達給使用者，例如警告圖示或狀態動畫訊息很重要的一部分。  
  
###  <a name="BKMK_PrioritizingAndLayering"></a> 設定優先順序和分層  
  
#### <a name="prioritizing-your-ui"></a>設定您的 UI  
它可能需要讓 forefront 特定 UI 項目，並將更多進階的行為和到對話方塊選項 （包括晦澀難懂的命令）。 留出空間，並讓它預設會在具有文字標籤 UI 對話方塊顯示時，則您可以將 forefront 常用的功能。  
  
#### <a name="layering-your-ui"></a>分層 UI  
如果您決定對話是必要，但您想要向使用者顯示相關的功能超出什麼可以顯示簡單的對話方塊中，您需要將您的 UI 層級。 Visual Studio 會使用最常見的分層方法為索引標籤和走廊上或儀表板。 在某些情況下，可能適合可以展開和摺疊的區域。 在 Visual Studio 中通常不建議自動調整 UI。  
  
有一些優點和缺點的分層透過類似索引標籤控制項的 UI 的不同方法。 檢閱下列清單以確保您所選擇的圖層項技術適合您的情況。  
  
##### <a name="tabbing"></a>定位處理  
  
| 切換機制 | 優點和適當的使用 | 缺點，並使用不當 |  
| --- | --- | --- |  
| 索引標籤控制項 | 以邏輯方式分組相關的設定的對話方塊頁面<br /><br />適用於少於五個 （或對話方塊上容納一個資料列中的標籤數目） 相關的控制項在對話方塊的頁面<br /><br />索引標籤必須簡短： 可以輕鬆地識別內容的一個或兩個字<br /><br />常見的系統對話方塊樣式<br /><br />範例：**檔案總管&gt;項目屬性** | 簡短的描述性標籤可能難以<br /><br />通常不超過五個索引標籤，在一個對話方塊中調整<br /><br />如果您有一個資料列 （使用替代的圖層項技術） 太多索引標籤不適當<br /><br />不是可延伸 |  
| 提要欄位巡覽 | 簡單的切換裝置可以容納更多的類別，比索引標籤<br /><br />類別目錄 （沒有階層） 的一般清單<br /><br />可延伸<br /><br />範例：**自訂...&gt; 將命令加入** | 不適合用於水平間距，如果有少於三個群組<br /><br />工作可能是更適合下拉式清單 |  
| 樹狀控制項 | 允許無限制的類別<br /><br />允許群組和/或階層架構的分類<br /><br />可延伸<br /><br />範例：**工具&gt;選項** | 有很大的巢狀階層，可能會導致過多的水平捲軸<br /><br />Visual Studio 的農民的樹狀檢視 |  
| 精靈 | 透過引導使用者完成以工作為基礎的循序步驟有助於工作完成： 精靈代表高層級的工作，個別面板代表完成整個任務所需的子工作<br /><br />當工作跨 Ui 界限，做為當使用者原本必須使用多個編輯器和工具視窗來完成工作時很有用<br /><br />當此工作需要分支時很有用<br /><br />當工作包含步驟之間的相依性時很有用<br /><br />當一個對話方塊，以減少不同類似的對話方塊數目可以呈現一個決策分岔與幾個類似的工作時很有用 | 不適用於任何不需要的循序工作流程的工作<br /><br />使用者只能成為爆滿困擾及困惑太多步驟的精靈<br /><br />精靈本質上具有有限的實際螢幕面積 |  
  
##### <a name="hallways-or-dashboards"></a>走廊上或儀表板  
走廊上和儀表板為對話或做為啟動指向其他對話方塊和視窗的面板。 設計良好的 「 隔壁 「 立即呈現只有最常見選項、 命令和設定，讓使用者輕易地完成一般工作。 真實世界隔壁提供通往存取後盾聊天室，如這裡較不常見 UI 被收集到個別 「 聊天室 」 （通常是其他對話方塊） 的相關的功能，可從主要隔壁存取。  
  
或者，UI，而不是重構到不同的位置較不常見功能是儀表板只提供單一集合中所有可用的功能。  
  
![公開額外的 UI，在 Outlook 中的 hallway 概念](../../extensibility/ux-guidelines/media/0704-08_hallway.png "0704年 08_Hallway")<br />公開額外的 UI，在 Outlook 中的 hallway 概念
  
##### <a name="adaptive-ui"></a>自動調整的 UI  
根據使用方式顯示或隱藏 UI，或自我報告的使用者體驗是必要的 UI 呈現時隱藏其他部分的另一種。 這不是建議在 Visual Studio 中，因為決定何時要顯示或隱藏 UI 的演算法可能很困難，而且規則將永遠為錯誤的情況下，某些集。  
  
##  <a name="BKMK_Projects"></a> 專案  
  
### <a name="projects-in-the-solution-explorer"></a>在 [方案總管] 中的專案  
大部分的專案會歸類為參考為基礎、 目錄為基礎，或混合。 在 [方案總管] 中同時支援所有的三種類型的專案。 使用專案中的使用者經驗的根目錄會發生在這個視窗內。 雖然不同的專案節點的參考、 目錄或混合模式類型的專案，但沒有常見的互動模式應該做為起點套用之前為分散到專案特定的使用者模式。  
  
專案應一律：  
  
-   支援的功能加入專案資料夾來組織專案內容  
  
-   維護一致的模型專案持續性  
  
專案也應維護一致的互動模型：  
  
-   移除專案項目  
  
-   儲存文件  
  
-   專案屬性編輯  
  
-   編輯替代的檢視中的專案  
  
-   拖放作業  
  
### <a name="drag-and-drop-interaction-model"></a>拖放互動模型  
專案通常分類本身做為參考為基礎 （能夠保留唯一參考儲存體中的專案項目），目錄為基礎 （能夠保留唯一的專案項目實際儲存在專案階層內），或混合的 （無法將保存的參考或實體的項目）。 IDE 內同時適用於所有三種專案類型**方案總管 中**。  
  
拖放的觀點而言，下列的特性應套用至每一種專案內**方案總管 中**:  
  
-   **參考為基礎的專案：**重點是專案正在拖曳的參考儲存體中的項目周圍。 當參考為基礎的專案做為移動作業的來源時，它應該只移除專案項目的參考。 項目不應實際刪除從硬碟機。 參考為基礎的專案做為移動 （或複製） 作業的目標，它應該將加入至原始的來源項目參考而不需要進行私用複本的項目。  
  
-   **目錄為基礎的專案：**拖放觀點來看，從專案拖曳的周圍實體項目，而不是參考。 當目錄為基礎的專案做為移動作業的來源時，它應該結束刪除實體的項目從硬碟機，以及從專案中移除。 當目錄為基礎的專案做為移動 （或複製） 作業的目標時，它應該複製一份來源項目在其目標位置。  
  
-   **混合目標專案：**拖放觀點來看，從這個專案類型的行為根據的本質 （儲存體中的項目參考），或是在項目本身被拖曳的項目。 參考和實體的項目正確的行為是上面所述。  
  
如果沒有專案中的一種**方案總管 中**，則會是很直接的拖放作業。 因為每個專案系統有定義它自己的拖放行為的能力，以確保可預測的使用者體驗，應遵循特定的指導方針 （根據 Windows 檔案總管 拖放行為）：  
  
-   未修改拖曳作業**方案總管 中**（當 Ctrl 或 Shift 鍵都不會同時按住） 應該會導致移動作業。  
  
-   Shift 拖曳作業也應該產生移動作業。  
  
-   Ctrl 拖曳作業時產生的複製作業。  
  
-   參考架構和混合的專案系統支援的來源項目加入連結 （或參考） 的概念。 當這些專案已拖放操作目標的 (當**按 Ctrl + Shift**按住)，它應該會導致項目加入專案的參考  
  
並非所有的拖放作業間都參考為基礎、 目錄為基礎和混合專案的組合是合理的。 特別是，它會偽裝成允許目錄為基礎的原始碼專案和參考為基礎的目標專案之間移動作業，因為來源目錄為基礎的專案會刪除來源項目，在完成移動到有問題。 目標參考為基礎的專案然後最後會出現已刪除項目的參考。  
  
它也是誤導偽裝成允許這些專案類型之間的複製作業，因為目標參考為基礎的專案不應做獨立之來源項目的複本。 同樣地，按 Ctrl + Shift 拖曳至目錄為基礎的目標專案應該會因為不允許目錄為基礎的專案無法保存的參考。 在其中拖放作業不支援的情況下，IDE 應該不允許卸除，並讓使用者不置放游標 （指標在下表中所示）。  
  
若要正確地實作拖放行為，在拖曳來源專案需要溝通本質上的目標專案。 （例如，這是參考或目錄為基礎？）這項資訊會以由來源所提供的剪貼簿格式。 專案應該做為來源的拖曳 （或剪貼簿複製作業） 提供 `CF_VSREFPROJECTITEMS`或`CF_VSSTGPROJECTITEMS`分別根據專案是參考或目錄。 這些格式都有相同的資料內容，類似於 Windows`CF_HDROP`格式化不同之處在於的字串，而不是檔案名稱的清單是 double-`NULL`終止份`Projref`字串 (傳回的`IVsSolution::GetProjrefOfItem`或`::GetProjrefOfProject`視需要)。  
  
專案應該做為目標的卸除 （或剪貼簿貼上作業），接受這兩`CF_VSREFPROJECTITEMS`和`CF_VSSTGPROJECTITEMS`，但是完全處理拖放作業的目標專案和原始碼專案的本質而有所不同。 來源專案宣告本質上，方法是是否提供`CF_VSREFPROJECTITEMS`或`CF_VSSTGPROJECTITEMS`。 卸除目標了解它自己的本質，因此會有足夠的資訊來決定與是否移動、 複製或連結，應執行。 使用者也會修改哪個拖放作業應該執行按下 Ctrl、 shift 鍵，或同時 Ctrl 和 Shift 鍵。 請務必正確地表示會執行哪些作業事先在置放目標其`DragEnter`和`DragOver`方法。 **方案總管] 中**自動知道 [原始碼專案和目標專案是否已在相同的專案。  
  
特別是不支援專案項目拖曳 （例如，從 devenv.exe 到另一個執行個體） 的 Visual Studio 執行個體。 **方案總管 中**這也會直接停用。  
  
使用者應該一定能夠判斷所選取項目、 將它拖曳到目標位置，並觀察出現在卸除項目之前的下列滑鼠指標的拖放作業的效果：  
  
| 滑鼠指標 | 命令 | 描述 |  
| :---: | --- | --- |  
| ![滑鼠 「 不置放 」 圖示](../../extensibility/ux-guidelines/media/0706-01_mousenodrop.png "0706年 01_MouseNoDrop") | 不卸除 | 無法卸除項目至指定的位置。 |  
| ![滑鼠 「 複製 」 圖示](../../extensibility/ux-guidelines/media/0706-02_mousecopy.png "0706年 02_MouseCopy") | 複製 | 項目會複製到目標位置。 |  
| ![滑鼠 「 移動 」 圖示](../../extensibility/ux-guidelines/media/0706-03_mousemove.png "0706年 03_MouseMove") | Move | 項目將會移至目標位置。 |  
| ![滑鼠 「 加入參考 」 圖示](../../extensibility/ux-guidelines/media/0706-04_mouseaddref.png "0706年 04_MouseAddRef") | 加入參考 | 選取項目的參考會加入到目標位置。 |

#### <a name="reference-based-projects"></a>參考為基礎的專案  
 下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應該根據來源項目和修飾詞索引鍵參考為基礎的目標專案已按下的本質：  
  
| 修飾詞 | 分類 | 來源項目： 參考/連結 | 來源項目： 實體的項目或檔案系統 (`CF_HDROP`) |  
| --- | --- | --- | --- |  
| 任何修飾詞 | 動作 | Move | 連結 |  
| 任何修飾詞 | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |  
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 會保留原始的項目 |  
| 任何修飾詞 | 結果 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_LINK` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |  
| Shift + 拖曳 | 動作 | Move | 不卸除 |  
| Shift + 拖曳 | 目標 | 將參考加入至原始項目 | 不卸除 |  
| Shift + 拖曳 | 原始程式檔 | 刪除原始項目的參考 | 不卸除 |  
| Shift + 拖曳 | 結果 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | 不卸除 |  
| Ctrl + 拖曳 | 動作 | 複製 | 不卸除 |  
| Ctrl + 拖曳 | 目標 | 將參考加入至原始項目 | 不卸除 |  
| Ctrl + 拖曳 | 原始程式檔 | 會保留原始項目的參考 | 不卸除 |  
| Ctrl + 拖曳 | 結果 | `DROPEFFECT_COPY` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | 不卸除 |  
| Ctrl + Shift + 拖曳 | 動作 | 連結 | 連結 |  
| Ctrl + Shift + 拖曳 | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |  
| Ctrl + Shift + 拖曳 | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |  
| Ctrl + Shift + 拖曳 | 結果 | `DROPEFFECT_LINK` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_LINK` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |  
| Ctrl + Shift + 拖曳 | 注意事項 | Windows 檔案總管 中的快速鍵的拖放行為相同。 ||  
| 剪下/貼上 | 動作 | Move | 連結 |  
| 剪下/貼上 | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |  
| 剪下/貼上 | 原始程式檔 | 會保留原始項目的參考|會保留原始的項目 |  
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |  
| 複製/貼上 | 動作 | 複製 | 連結 |  
| 複製/貼上 | 原始程式檔 | 將參考加入至原始項目 | 將參考加入至原始項目 |  
| 複製/貼上 | 結果 | 會保留原始項目的參考 | 會保留原始的項目 |  
| 複製/貼上 | 動作 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |  
  
#### <a name="directory-based-projects"></a>目錄為基礎的專案  
下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應根據目錄為基礎的目標專案已按下的來源項目和修飾詞索引鍵的本質：  
  
| 修飾詞 | 分類 | 來源項目： 參考/連結 | 來源項目： 實體的項目或檔案系統 (`CF_HDROP`) |  
| --- | --- | --- | --- |  
| 任何修飾詞 | 動作 | Move | Move |  
| 任何修飾詞 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |  
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 刪除原始項目的參考 | | 任何修飾詞 | 結果 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |  
| Shift + 拖曳 | 動作 | Move | Move |  
| Shift + 拖曳 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |  
| Shift + 拖曳 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| Shift + 拖曳 | 結果 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |  
| Ctrl + 拖曳 | 動作 | 複製 | 複製 |  
| Ctrl + 拖曳 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |  
| Ctrl + 拖曳 | 原始程式檔 | 會保留原始項目的參考 | 會保留原始項目的參考 |  
| Ctrl + 拖曳 | 結果 | `DROPEFFECT_COPY` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_COPY` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |  
| Ctrl + Shift + 拖曳 | | 不卸除 | 不卸除 |  
| 剪下/貼上 | 動作 | Move | Move |  
| 剪下/貼上 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |  
| 剪下/貼上 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |  
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 從儲存體中的原始位置刪除項目 |  
| 複製/貼上 | 動作 | 複製 | 複製 |  
| 複製/貼上 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |  
| 複製/貼上 | 原始程式檔 | 會保留原始的項目 | 會保留原始的項目 |  
| 複製/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目仍會保留在原始位置單元存放裝置 |
  
#### <a name="mixed-target-projects"></a>混合目標的專案  
下表摘要說明拖放 （以及剪下/複製/貼上） 執行的作業應該根據混合目標專案已按下的來源項目和修飾詞索引鍵的本質：  
  
| 修飾詞 | 分類 | 來源項目： 參考/連結 | 來源項目： 實體的項目或檔案系統 (`CF_HDROP`) |  
| --- | --- | --- | --- |
| 任何修飾詞 | 動作 | Move | Move |
| 任何修飾詞 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 刪除原始項目的參考 |
| 任何修飾詞 | 結果 | `DROPEFFECT_ MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ MOVE` 傳回動作為`::Drop`和從儲存體中的原始位置刪除項目 |
| Shift + 拖曳 | 動作 | Move | Move |
| Shift + 拖曳 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| Shift + 拖曳 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 | 
| Shift + 拖曳 | 結果 | `DROPEFFECT_ MOVE` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ MOVE` 傳回動作為`::Drop`和從儲存體中的原始位置刪除項目 |
| Ctrl + 拖曳 | 動作 | 複製 | 複製 |
| Ctrl + 拖曳 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| Ctrl + 拖曳 | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |
| Ctrl + 拖曳 | 結果 | `DROPEFFECT_ COPY` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ COPY` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |
| Ctrl + Shift + 拖曳 | 動作 | 連結 | 連結 |
| Ctrl + Shift + 拖曳 | 目標 | 將參考加入至原始項目 | 將參考加入至原始的來源項目 |
| Ctrl + Shift + 拖曳 | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |
| Ctrl + Shift + 拖曳 | 結果 | `DROPEFFECT_ LINK` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ LINK` 傳回動作為`::Drop`和項目會保留在儲存體中的原始位置 |
| 剪下/貼上 | 動作 | Move | Move |
| 剪下/貼上 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| 剪下/貼上 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 從儲存體中的原始位置刪除項目 |
| 複製/貼上 | 動作 | 複製 | 複製 |
| 複製/貼上 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| 複製/貼上 | 原始程式檔 | 會保留原始的項目 | 會保留原始的項目 |
| 複製/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |
  
這些詳細資料應列入考量時實作中拖曳**方案總管 中**:  
  
-   多個選取項目案例的設計。  
  
-   檔案名稱 （完整路徑） 必須是唯一的目標專案或卸除不被允許。  
  
-   資料夾名稱不得重複 （不區分大小寫） 正在捨棄層級。  
  
-   沒有檔案開啟或關閉拖放到 （上述案例中未提及） 的時間之間的行為差異。  
  
-   最上層檔案的行為稍有不同資料夾中的檔案。  
  
另一個要注意的問題是如何處理具有開啟的設計工具或編輯器項目上的移動作業。 預期的行為是，如下所示 （適用於所有專案類型）：  
  
1.  如果開啟編輯器/設計工具並沒有任何未儲存的變更，然後編輯器/設計工具視窗應該會以無訊息模式關閉。  
  
2.  如果開啟編輯器/設計工具沒有未儲存的變更，然後拖曳來源應該等候以發生然後要求使用者儲存開啟的文件的未認可的變更之前關閉 [具有類似下列的提示字元] 視窗拖放:  
  
    ```  
    ==========================================================   
         One or more open documents have unsaved changes.  
    Do you want to save uncommitted changes before proceeding?   
                      [Yes]  [No]  [Cancel]   
    ==========================================================  
    ```  
  
這讓使用者有機會進行中的工作前先加以儲存目標會建立其複本。 新方法`IVsHierarchyDropDataSource2::OnBeforeDropNotify`已啟用這項處理。  
  
目標然後將複製項目的狀態，因為它是在儲存體 (不包括未儲存的變更在編輯器中，如果使用者選擇**否**)。 目標已完成其複製之後 (在`IVsHierarchyDropDataSource::Drop`)，來源就有機會完成移動作業的刪除部分 (在`IVsHierarchyDropDataSource::OnDropNotify`)。  
  
任何未儲存的變更與編輯器應該保持開啟狀態。 如有變更尚未儲存這些文件，這表示將會執行移動操作中複製的一部分，但將會中止刪除部分。 在多個選取項目案例當使用者選擇**否**，有變更尚未儲存這些文件不應該關閉或移除，但不含未儲存的變更應該關閉並移除。